# âœˆï¸ Aviatickets - ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ°Ğ²Ğ¸Ğ°Ğ±Ğ¸Ğ»ĞµÑ‚Ğ¾Ğ²

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
aviaticketsmarketnew/
â”‚
â”œâ”€â”€ ğŸ“± aviatickets-demo/                    # React Native Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ (Expo)
â”‚   â”œâ”€â”€ screens/                            # Ğ­ĞºÑ€Ğ°Ğ½Ñ‹
â”‚   â”‚   â”œâ”€â”€ HomeScreen.js                   # Ğ“Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ ÑĞºÑ€Ğ°Ğ½
â”‚   â”‚   â”œâ”€â”€ LoginScreen.js                  # Ğ’Ñ…Ğ¾Ğ´
â”‚   â”‚   â”œâ”€â”€ SignUpScreen.js                 # Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ
â”‚   â”‚   â”œâ”€â”€ BookingScreen.js                # Ğ‘Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
â”‚   â”‚   â”œâ”€â”€ TicketsScreen.js                # ĞœĞ¾Ğ¸ Ğ±Ğ¸Ğ»ĞµÑ‚Ñ‹
â”‚   â”‚   â”œâ”€â”€ ProfileScreen.js                # ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ
â”‚   â”‚   â”œâ”€â”€ AccountScreen.js                # Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ
â”‚   â”‚   â””â”€â”€ ...                             # Ğ”Ñ€ÑƒĞ³Ğ¸Ğµ ÑĞºÑ€Ğ°Ğ½Ñ‹
â”‚   â”‚
â”‚   â”œâ”€â”€ navigation/                         # ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ
â”‚   â”‚   â”œâ”€â”€ RootNavigation.js               # ĞšĞ¾Ñ€Ğ½ĞµĞ²Ğ°Ñ Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ
â”‚   â”‚   â””â”€â”€ BottomTabs.js                   # ĞĞ¸Ğ¶Ğ½Ğ¸Ğµ Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ contexts/                           # React Context
â”‚   â”‚   â””â”€â”€ AuthContext.js                  # ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/                                # Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹
â”‚   â”‚   â””â”€â”€ api.js                          # API ĞºĞ»Ğ¸ĞµĞ½Ñ‚
â”‚   â”‚
â”‚   â”œâ”€â”€ constants/                          # ĞšĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñ‹
â”‚   â”‚   â””â”€â”€ api.js                          # API_BASE URL
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                         # ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
â”‚   â”œâ”€â”€ App.js                              # Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ°
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ ğŸ–¥ï¸ tickets-backend/                     # NestJS Backend
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ auth/                           # ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.controller.ts          # POST /api/auth/login, /api/auth/register
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ jwt.strategy.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ users/                          # ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ users.controller.ts         # GET/PUT /api/me
â”‚   â”‚   â”‚   â””â”€â”€ users.service.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ booking/                        # Ğ‘Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
â”‚   â”‚   â”‚   â”œâ”€â”€ booking.controller.ts       # POST /api/booking/create, GET /api/booking
â”‚   â”‚   â”‚   â””â”€â”€ booking.service.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ flights/                        # Ğ ĞµĞ¹ÑÑ‹
â”‚   â”‚   â”œâ”€â”€ onelya/                         # Onelya API
â”‚   â”‚   â”œâ”€â”€ faq/                            # FAQ
â”‚   â”‚   â”œâ”€â”€ support/                        # ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ schemas/                        # MongoDB ÑÑ…ĞµĞ¼Ñ‹
â”‚   â”‚   â”‚   â”œâ”€â”€ user.schema.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ booking.schema.ts
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ main.ts                         # Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ° (app.setGlobalPrefix('api'))
â”‚   â”‚   â””â”€â”€ app.module.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ scripts/                            # Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹
â”‚   â”‚   â”œâ”€â”€ seed-atlas-user.js              # Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
â”‚   â”‚   â”œâ”€â”€ full-diagnosis.js               # Ğ”Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ°
â”‚   â”‚   â””â”€â”€ test-server.sh                  # Ğ¢ĞµÑÑ‚ API
â”‚   â”‚
â”‚   â”œâ”€â”€ .env                                # ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
â”‚   â””â”€â”€ package.json
â”‚
â””â”€â”€ ğŸ“š Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ/
    â”œâ”€â”€ README.md                           # Ğ­Ñ‚Ğ¾Ñ‚ Ñ„Ğ°Ğ¹Ğ»
    â”œâ”€â”€ PROJECT_STRUCTURE.md                # ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°
    â”œâ”€â”€ FIX_ROUTES.md                       # Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ€Ğ¾ÑƒÑ‚Ğ¾Ğ²
    â”œâ”€â”€ COMPLETE_SOLUTION.md                # ĞŸĞ¾Ğ»Ğ½Ğ¾Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ
    â””â”€â”€ ...
```

## ğŸ”‘ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹

### Backend
- `tickets-backend/src/main.ts` - **app.setGlobalPrefix('api')** âš ï¸ Ğ’ĞĞ–ĞĞ!
- `tickets-backend/.env` - JWT_SECRET, MONGO_URI
- `tickets-backend/src/auth/auth.service.ts` - Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

### Frontend
- `aviatickets-demo/constants/api.js` - **API_BASE = 'http://193.233.103.8:3000/api'**
- `aviatickets-demo/lib/api.js` - Ğ¦ĞµĞ½Ñ‚Ñ€Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ API ĞºĞ»Ğ¸ĞµĞ½Ñ‚
- `aviatickets-demo/contexts/AuthContext.js` - Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹

## ğŸŒ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

### Backend (tickets-backend/.env)
```env
PORT=3000
JWT_SECRET=a7f3e9c2b8d4f1a6e5c9b3d7f2a8e4c1b9d5f3a7e2c8b4d1f6a9e3c7b2d8f4a1
MONGO_URI=mongodb+srv://Misha110208:Misha110208@aviamarket.7o9kplj.mongodb.net/tickets?retryWrites=true&w=majority&appName=aviamarket
ONELYA_BASE_URL=https://api-test.onelya.ru/
ONELYA_LOGIN=trevel_test
ONELYA_PASSWORD=5mPaN5KyB!27LN!
ONELYA_POS=trevel_test
NODE_ENV=production
```

### Frontend (aviatickets-demo/constants/api.js)
```javascript
export const API_BASE = 'http://193.233.103.8:3000/api';
```

## ğŸ—„ï¸ Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

**MongoDB Atlas:**
- URI: `mongodb+srv://...@aviamarket.7o9kplj.mongodb.net/tickets`
- Ğ‘Ğ°Ğ·Ğ°: `tickets`
- ĞšĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸: `users`, `bookings`, `faqs`, `supportmessages`

## ğŸ” Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚

```
Email: test@test.com
ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ: 123456
ID: 6930a7f7500ef1c618143a14
```

## ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº

### Backend
```bash
cd tickets-backend
npm install
npm run start:dev
```

### Frontend
```bash
cd aviatickets-demo
npm install
npx expo start
```

## ğŸ“¡ API Endpoints

Ğ’ÑĞµ Ñ€Ğ¾ÑƒÑ‚Ñ‹ Ñ Ğ¿Ñ€ĞµÑ„Ğ¸ĞºÑĞ¾Ğ¼ `/api`:

### ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
- `POST /api/auth/login` - Ğ’Ñ…Ğ¾Ğ´
- `POST /api/auth/register` - Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ

### ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ
- `GET /api/me` - ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ
- `PUT /api/me` - ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ

### Ğ‘Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- `POST /api/booking/create` - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- `GET /api/booking` - Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹
- `GET /api/booking/:id` - ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- `GET /api/booking/:id/pdf` - Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ PDF Ğ±Ğ¸Ğ»ĞµÑ‚

### Ğ”Ñ€ÑƒĞ³Ğ¸Ğµ
- `GET /api/faq` - FAQ
- `GET /api/support/messages` - Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¸
- `POST /api/support/messages` - ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ

## ğŸ”§ Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ

### âœ… Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾
1. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ `app.setGlobalPrefix('api')` Ğ² main.ts
2. API_BASE Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Ğ½Ğ° `http://193.233.103.8:3000/api`
3. Ğ’ÑĞµ fetch Ğ·Ğ°Ğ¼ĞµĞ½ĞµĞ½Ñ‹ Ğ½Ğ° Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½ÑƒÑ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ api()
4. ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ° (Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Login Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ)

### âš ï¸ Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€Ğµ
ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ `main.ts` Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€Ğµ Timeweb (ÑĞ¼. FIX_ROUTES.md)

## ğŸ“Š ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         HTTP          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Expo App  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ NestJS API   â”‚
â”‚  (Mobile)   â”‚  /api/auth/login     â”‚ (Timeweb)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â”‚ Mongoose
                                             â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚ MongoDB      â”‚
                                      â”‚ Atlas        â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸

**Frontend:**
- React Native (Expo)
- React Navigation
- AsyncStorage
- Expo Image Picker

**Backend:**
- NestJS
- MongoDB (Mongoose)
- JWT Authentication
- Swagger UI
- PDFKit (Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ±Ğ¸Ğ»ĞµÑ‚Ğ¾Ğ²)

**Ğ’Ğ½ĞµÑˆĞ½Ğ¸Ğµ API:**
- Onelya API (Ğ¿Ğ¾Ğ¸ÑĞº Ñ€ĞµĞ¹ÑĞ¾Ğ²)
